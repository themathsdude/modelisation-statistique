---
title: "Mais qui as-des téléphones ?!"
author: "Justine Blanchot et Elyass Sayd, Groupe 0"
date: "13/02/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(comment = NA)
```

### Introduction

Avant la fameuse conférence *Apple Keynote* de 2007 par Steve Jobs où il annonçait la sortie du premier iPhone, personne n'aurait pu imaginer que les écrans tactiles se retrouveraient dans toutes les mains. L'iPhone était le précurseur du marché des smartphones qui a connu une des expansions les plus fulgurantes avec l'amélioration constante des infrastructures internet. Aurions-nous pu prévoir quels marchés allaient-être les plus réceptifs à l'arrivée de cette technologie? À l'aide de quels critères? Nous allons au fil de ce rapport nous questionner sur les corrélations possibles pour un pays donné entre le nombre de téléphones pour mille habitants et différents critères de développement. 


### Problématique et objectif

A partir d'un jeu de données issu de Kaggle, publié en 2017 par Fernando Lasso, intitulé "Countries of the world" et rassemblant des données du gouvernement américain (Anciennes données du CIA World Factbook et International Consortium for the Advancement of Academic Publication  https://gsociology.icaap.org/dataupload.html), nous allons essayer d'expliquer la déjà existante fougue du téléphone mobile en 2000 en fonction de certains indicateurs. 
Si le temps nous le permets, nous comparerons notre analyse avec une tendance plus récente, à l'aide de nouvelles données du World Factbook.

Nous tenterons donc de répondre à la problématique suivante:

#### **Aurions-nous pu anticiper la réussite du marché des téléphones portables dans un pays à l'aide des indicateurs classiques de développement? Si oui, à l'aide desquels? **


### I- Analyse descriptive des données

#### A- Analyse du jeu de données

Le jeu de données que nous avons choisi contient les données de 227 pays par rapport à 19 variables. Dans le cadre de cette étude, nous nous limiterons aux variables suivantes: la région d'appartenance du pays, la densité de population (nombre habitants par miles carré), le PIB par habitant et enfin la part de la population active travaillant dans l'agriculture, l’industrie et les services.

Pour être en adéquation avec les consignes du projet, nous avons vérifié que nous avions bien plus de 100 données (227 dans notre cas), et nous avons choisi 6 variables d’intérêt, parce qu’il était recommandé d’en prendre 3 ou 4 minimum. Nous avons également renommé les noms des colonnes du fichier en français. On remarque également que notre variable d’intérêt possède 4 valeurs manquantes, nous décidons de les retirer.
  

```{r}
library("ggplot2")
library(ggThemeAssist)
df.countries <- read.csv("countries.csv", dec=",")
rownames(df.countries) <- df.countries$Pays
vec_retirer <- is.na(df.countries$Téléphones)
df.countries <- df.countries[!vec_retirer, ]
```

#### B- Analyse univariée de la variable d'intérêt

Introduisons des notations:
$T$, pour téléphones, est la variables à expliquer, c'est-à-dire le nombres de téléphones pour mille habitants. 
  
$T$ est la réalisation d'une variable aléatoire $X$. Dans cette première partie, nous allons analyser les données de $T$ et essayer de déterminer la loi de $X$. Commençons par faire un résumé sur notre variable à l'aide de quelques caractéristiques:

Avant toutes recherches plus précises sur notre variable, nous allons nous convaincre qu'elle est continue. Pour ce faire, traçons sa fonction de répartition empirique. 

```{r}
sommaire <- summary(df.countries$Téléphones)
mu = sommaire["Mean"]
a <- ggplot(df.countries, aes(Téléphones)) + stat_ecdf(geom="step") + labs(title="Fonction de répartition empirique de T" ) + xlab("Nombres de téléphones pour mille habitants") + ylab("")
a <- a + stat_function(fun = function(x) {pexp(x, rate = 1/mu)}, col = 'blue')
cex.main = 2
cex.lab = 1.5
long <- length(unique(df.countries$Téléphones))
a
```
    
On voit que la fonction de répartition empirique réalise beaucoup de sauts. Elle en réalise exactement `r long`. `r long` est "grand" devant 247 donc notre variable d’intérêt est continue. 
  
Nous pouvons alors tracer son histogramme. 
  
```{r}
dens_pareto <- function(x, k, xm) {
  return((k*(xm/x)^k)/x)
}
hist <- ggplot(df.countries, aes(Téléphones)) + geom_histogram(bins = 8, aes(y = stat(density)))
hist <- hist + labs(title="Histogramme de T" ) + xlab("Nombres de téléphones pour mille habitants") + ylab("")
hist <- hist + stat_function(fun = function(x) {dexp(x, rate = 1/mu)}, col = 'blue')
xmin <- min(df.countries$Téléphones)
xmin <- 1
# hist <- hist + stat_function(fun = function(x) {dens_pareto(x, k=mu/(mu-xmin), xm = xmin)}, xlim=c(xmin, 1000))
hist
```
  
  Au vue de cet histogramme, nous pouvons penser que $T$ est un échantillon de loi exponentielle, ie $X$ suit une loi exponentielle de paramètre $\lambda$. L'espérance d'une loi exponentielle est $\frac{1}{\lambda}$. La méthode des moments nous propose la moyenne empirique de $T$ qui est un estimateur sans biais, consistant et asymptotiquement normal de l'espérance de $T$, c'est à dire $\frac 1 \lambda$. Profitons-en pour afficher quelques caractéristiques de $T$: 
  
```{r}
sommaire <- summary(df.countries$Téléphones)
mu = sommaire["Mean"]
sommaire
```
Ainsi, la moyenne empirique de $T$ est $\hat \mu =$ `r mu`. En prenant $\hat \lambda = \frac{1}{236.1} = 4.24 \cdot 10^{-3}$, nous voulons vérifier que notre hypothèse est plausible. Nous allons alors tracer:
   
1.  L'histogramme de $T$ et la densité $\hat \lambda e^{\hat \lambda x}$

2.  La fonction de répartition empirique de $T$ et sa fonction de répartition théorique.

3.  Le QQ-plot de entre les réalisation théoriques et empiriques de $T$.
   
```{r}
rexpsample <- rexp(length(df.countries$Téléphones), rate = 1/mu)
ks.test(df.countries$Téléphones, rexpsample)
```

```{r}
cdfexp <- function(x, rate) {
  return(1-exp(rate*x))
}
df.qq <- data.frame(df.countries$Téléphones)
names(df.qq) <- "Téléphones"
df.qq$Téléphones <- df.qq$Téléphones/mu
qqplot <- ggplot(data = df.qq, aes(sample = Téléphones)) + stat_qq(distribution = stats::qexp)
qqplot <- qqplot + geom_abline(intercept = 0,slope = 1,col = "blue")
qqplot

```

```{r}
ggplot(data=df.countries) + aes(x=as.factor(Région), y=Téléphones) + scale_x_discrete(guide = guide_axis(n.dodge=4)) + geom_boxplot()
```

```{r}
ggplot(data=df.countries) + aes(y=Téléphones) + geom_boxplot()
```




